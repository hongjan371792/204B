<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/png" href="Dino.png">
<title>204B by hongjan</title>
<style>
/* 调整文字样式 */
#muteLabel {
  margin-right: 10px;
  color: white;
  font-size: 16px;
}

body {
  margin: 0;
  padding: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column; /* 讓標題和按鈕垂直排列 */
  height: 100vh;
  background-color: #2a8fd3;
  position: relative; /* 設定父容器 */
}

canvas {
  border: 5px solid #000000;
  position: relative; /* 設定 canvas 為相對定位 */
  width: 100%;
  max-width: 600px; /* 設定最大寬度為 600px，以防止內容在大螢幕上過寬 */
}

.button {
  background-color: #ff7300; /* 橘色 */
  border: none;
  color: rgb(233, 233, 233);
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 4px 2px;
  cursor: pointer;
  border-radius: 8px;
}

.button:hover {
  background-color: #a14e00; /* 深橘色 */
}

.text-background {
  width: 100%;
  height: 50px; /* 調整高度以適應文字 */
  background-color: #2a8fd3; /* 背景色與 body 相同 */
  position: absolute; /* 絕對定位 */
  bottom: 0; /* 與底部對齊 */
}

/* 手機和平板設備樣式 */
@media only screen and (max-width: 768px) {
  body {
    transform: scale(0.8); /* 縮小整個畫面 */
    transform-origin: top center; /* 設定縮放原點為畫面頂部中心 */
  }
}

.container {
  display: none; /* 隱藏遊戲版面 */
  flex-wrap: wrap;
  width: 320px;
  margin: 20px auto;
  border: 2px solid #000000;
  padding: 5px;
}

.cell {
  width: 70px;
  height: 70px;
  margin: 5px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 24px;
  font-weight: bold;
  position: relative; /* 相對定位 */
  background-image: url('logo.png'); /* 使用相同的logo.png作為背景圖片 */
  background-size: cover; /* 使圖片填滿整個格子 */
  color: #333; /* 設定文字顏色 */
}

#startInterface {
  display: flex;
  flex-direction: column;
  align-items: center;
  color: white; /* 設定文字顏色 */
}

.failure {
  color: red; /* 設定失敗文字顏色 */
  font-weight: bold; /* 加粗文字 */
}

</style>
</head>
<body>
<div class="container" id="container"></div>

<!-- 開始介面 -->
<div id="startInterface">
  <h1>204B</h1>
  <p>使用方向鍵控制</p>
  <p>作者：hongjan</p>
  <p id="failureMessage" class="failure" style="display: none;">失敗！無法再移動。</p>
  <button id="startButton" class="button">開始遊戲</button>
  <a href="https://github.com/hongjan371792/Dino" class="button" target="_blank">GitHub</a>
  <a id="githubLink" class="button" target="_blank">Gihub API載入中</a> <!-- GitHub 按钮 -->
</div>

<canvas id="gameCanvas" width="600" height="600" style="display: none;"></canvas>
<button id="restartButton" class="button" style="display: none;">重新開始</button>
<div class="text-background"></div>
<script>
// JavaScript 代码部分
const container = document.getElementById('container');
let board = [];

function initializeBoard() {
  for (let i = 0; i < 4; i++) {
    board[i] = [];
    for (let j = 0; j < 4; j++) {
      board[i][j] = 0;
    }
  }
  addRandomTile();
  addRandomTile();
  renderBoard();
}

function addRandomTile() {
  let emptyCells = [];
  for (let i = 0; i < 4; i++) {
    for (let j = 0; j < 4; j++) {
      if (board[i][j] === 0) {
        emptyCells.push({ x: i, y: j });
      }
    }
  }
  if (emptyCells.length > 0) {
    const { x, y } = emptyCells[Math.floor(Math.random() * emptyCells.length)];
    board[x][y] = Math.random() < 0.9 ? 2 : 4;
  }
}

function renderBoard() {
  container.innerHTML = '';
  for (let i = 0; i < 4; i++) {
    for (let j = 0; j < 4; j++) {
      if (board[i][j] !== 0) { // 如果不是零，則顯示數字
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.innerText = board[i][j];
        container.appendChild(cell);
      } else { // 如果是零，則不顯示
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.style.visibility = 'hidden'; // 將零的格子隱藏
        container.appendChild(cell);
      }
    }
  }
}

// 開始遊戲按鈕點擊事件
document.getElementById('startButton').addEventListener('click', function() {
  document.getElementById('startInterface').style.display = 'none'; // 隱藏開始介面
  document.getElementById('container').style.display = 'flex'; // 顯示遊戲版面
  document.getElementById('failureMessage').style.display = 'none'; // 隱藏失敗訊息
  initializeBoard(); // 初始化遊戲版面
});

// 方向鍵控制
document.addEventListener('keydown', function(event) {
  if ([37, 38, 39, 40].includes(event.keyCode)) {
    event.preventDefault();
    console.log('Arrow key pressed:', event.keyCode);
    // 在此處添加你的方向鍵控制邏輯
    switch(event.keyCode) {
      case 37: // 左箭頭
        moveLeft();
        break;
      case 38: // 上箭頭
        moveUp();
        break;
      case 39: // 右箭頭
        moveRight();
        break;
      case 40: // 下箭頭
        moveDown();
        break;
    }
  }
});

function moveRight() {
  // 在此添加向右移動邏輯
  for (let i = 0; i < 4; i++) {
    for (let j = 2; j >= 0; j--) {
      if (board[i][j] !== 0) {
        let k = j + 1;
        while (k < 4) {
          if (board[i][k] === 0) {
            board[i][k] = board[i][k - 1];
            board[i][k - 1] = 0;
            k++;
          } else if (board[i][k] === board[i][k - 1]) {
            board[i][k] *= 2;
            board[i][k - 1] = 0;
            break;
          } else {
            break;
          }
        }
      }
    }
  }
  addRandomTile();
  renderBoard();
}

function moveLeft() {
  // 在此添加向左移動邏輯
  for (let i = 0; i < 4; i++) {
    for (let j = 1; j < 4; j++) {
      if (board[i][j] !== 0) {
        let k = j - 1;
        while (k >= 0) {
          if (board[i][k] === 0) {
            board[i][k] = board[i][k + 1];
            board[i][k + 1] = 0;
            k--;
          } else if (board[i][k] === board[i][k + 1]) {
            board[i][k] *= 2;
            board[i][k + 1] = 0;
            break;
          } else {
            break;
          }
        }
      }
    }
  }
  addRandomTile();
  renderBoard();
}

function moveUp() {
  // 在此添加向上移動邏輯
  for (let j = 0; j < 4; j++) {
    for (let i = 1; i < 4; i++) {
      if (board[i][j] !== 0) {
        let k = i - 1;
        while (k >= 0) {
          if (board[k][j] === 0) {
            board[k][j] = board[k + 1][j];
            board[k + 1][j] = 0;
            k--;
          } else if (board[k][j] === board[k + 1][j]) {
            board[k][j] *= 2;
            board[k + 1][j] = 0;
            break;
          } else {
            break;
          }
        }
      }
    }
  }
  addRandomTile();
  renderBoard();
}

function moveDown() {
  // 在此添加向下移動邏輯
  for (let j = 0; j < 4; j++) {
    for (let i = 2; i >= 0; i--) {
      if (board[i][j] !== 0) {
        let k = i + 1;
        while (k < 4) {
          if (board[k][j] === 0) {
            board[k][j] = board[k - 1][j];
            board[k - 1][j] = 0;
            k++;
          } else if (board[k][j] === board[k - 1][j]) {
            board[k][j] *= 2;
            board[k - 1][j] = 0;
            break;
          } else {
            break;
          }
        }
      }
    }
  }
  addRandomTile();
  renderBoard();
}

</script>
</body>
</html>